<database defaultIdMethod="native" package="objectives.classes" name="application" >
 	<!--Tablas de modulo objetivos-->

	<table name="objectives_policyGuideline" phpName='PolicyGuideline' description="Policy Guidelines">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Policy Guideline Id" autoIncrement="true"/>
		<column name="name" required="true"  type="LONGVARCHAR" size="255" description="Policy Guideline Name"/>
		<column name="description" type="LONGVARCHAR" description="Policy Guideline Description"/>
		<column name="exchangeRate" type="FLOAT" description="Exchange Rate" />
		<column name="userId" type="INTEGER" description="User Id " />
		<column name="objectType" description="Tipo de usuario" type="VARCHAR" size="50" required="true" />
		<column name="objectId" description="Id del usuario" type="INTEGER" required="true" />
		<column name="startingYear" type="INTEGER" description="Starting year" />
		<column name="endingYear" type="INTEGER" description="Endign year" />
		<column name="updated" type="TIMESTAMP"  description="Updated"/>
		<column name="changes" type="INTEGER" description="Cantidad de modificaciones"/>
	
		<behavior name="soft_delete" />

		<foreign-key foreignTable="users_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

	</table>

	<table name="objectives_policyGuidelineIndicators" phpName='PolicyGuidelineIndicators' isCrossRef="true" description="Relacion PolicyGuideline e Indicadores">
		<column name="indicatorId" required="true" primaryKey="true" type="INTEGER" size="4" description="Id Indicador"/>
		<column name="policyGuidelineId" required="true" primaryKey="true" type="INTEGER" size="5" description="PolicyGuideline Id"/>

	  <foreign-key foreignTable="objectives_policyGuideline" onDelete="CASCADE">
	    <reference local="policyGuidelineId" foreign="id" />
	  </foreign-key>

	  <foreign-key foreignTable="indicators_indicator" onDelete="CASCADE">
	    <reference local="indicatorId" foreign="id" />
	  </foreign-key>

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table name="objectives_strategic" phpName='StrategicObjective' description="Strategic Objective">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Objective Id" autoIncrement="true"/>
		<column name="policyGuidelineId" type="INTEGER" description="Policy Guideline Id"/>
		<column name="name" required="true"  type="LONGVARCHAR" size="255" description="Objective Name"/>
		<column name="description" type="LONGVARCHAR" description="Objective Description"/>
		<column name="userId" type="INTEGER" description="User Id " />
		<column name="affiliateId" required="true" type="INTEGER" description="Affiliate Id"/>
		<column name="userByAffiliatesId" type="INTEGER" description="UserByAffiliates Id" />
		<column name="updated" type="TIMESTAMP"  description="Updated"/>
		<column name="changes" type="INTEGER" description="Cantidad de modificaciones"/>
		<column name="oldId" type="INTEGER" description="Old Id"/>

		<behavior name="soft_delete" />

		<foreign-key foreignTable="objectives_policyGuideline" >
			<reference local="policyGuidelineId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="users_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

<!--		<foreign-key foreignTable="affiliates_affiliate" >
			<reference local="affiliateId" foreign="id" />
		</foreign-key> -->

<!--		<foreign-key foreignTable="affiliates_user" >
			<reference local="userByAffiliatesId" foreign="id" />
		</foreign-key> -->

	</table>

	<table name="objectives_objective" phpName='Objective' description="Objective">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Objective Id" autoIncrement="true"/>
		<column name="name" required="true"  type="VARCHAR" size="255" description="Objective Name"/>
		<column name="policyGuidelineId" required="true" type="INTEGER" description="Strategic Objective Id"/>
		<column name="strategicObjectiveId" required="true" type="INTEGER" description="Strategic Objective Id"/>
		<column name="affiliateId" required="true" type="INTEGER" description="Affiliate Id"/>
		<column name="description" type="LONGVARCHAR" description="Objective Description"/>
		<column name="date" type="DATE"  description="Objective Date"/>
		<column name="expirationDate" type="DATE"  description="Objective Expiration Date (Fecha Vencimiento)"/>
		<column name="achieved" type="BOOLEAN"  description="is Objective achieved?"/>
		<column name="notes" type="LONGVARCHAR"  description="Objective Notes"/>
		<column name="responsibleCode" type="INTEGER" description="Position Code"/>
		<column name="userId" type="INTEGER" description="User Id " />
		<column name="userByAffiliatesId" type="INTEGER" description="UserByAffiliates Id" />
		<column name="updated" type="TIMESTAMP"  description="Updated"/>
		<column name="changes" type="INTEGER" description="Cantidad de modificaciones"/>
		<column name="oldId" type="INTEGER" description="Old Id"/>

		<behavior name="soft_delete" />

<!--		<unique>
			<unique-column name="name" />
		</unique>
-->		
		<foreign-key foreignTable="objectives_strategic" >
			<reference local="strategicObjectiveId" foreign="id" />
		</foreign-key>
		
		<foreign-key foreignTable="objectives_policyGuideline" >
			<reference local="policyGuidelineId" foreign="id" />
		</foreign-key>

<!--		<foreign-key foreignTable="affiliates_affiliate" >
			<reference local="affiliateId" foreign="id" />
		</foreign-key> -->

		<foreign-key foreignTable="users_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

<!--		<foreign-key foreignTable="affiliates_user" >
			<reference local="userByAffiliatesId" foreign="id" />
		</foreign-key> -->

		<foreign-key foreignTable="positions_position" >
			<reference local="responsibleCode" foreign="code" />
		</foreign-key>

	</table>

	<table name="objectives_region" phpName='ObjectiveRegion' isCrossRef="true" description="Asociacion entre Regiones y Objetivos">
		<column name="regionId" required="true" primaryKey="true" type="INTEGER" />
		<column name="objectiveId" required="true" primaryKey="true" type="INTEGER" />

		<foreign-key foreignTable="regions_region" >
			<reference local="regionId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="objectives_objective" >
			<reference local="objectiveId" foreign="id" />
		</foreign-key>

	</table>


<!--
Seccion de tablas de log
-->

	<table name="objectives_policyGuidelineLog" phpName='PolicyGuidelineLog' description="Policy Guidelines">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Policy Guideline Id" autoIncrement="true"/>
		<column name="policyGuidelineId" type="INTEGER" description="Policy Guideline Id"/>
		<column name="name" required="true"  type="LONGVARCHAR" size="255" description="Policy Guideline Name"/>
		<column name="description" type="LONGVARCHAR" description="Policy Guideline Description"/>
		<column name="userId" type="INTEGER" description="User Id " />
		<column name="updated" type="TIMESTAMP"  description="Updated"/>
		<column name="changes" type="INTEGER" description="Cantidad de modificaciones"/>

		<foreign-key foreignTable="objectives_policyGuideline" >
			<reference local="policyGuidelineId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="users_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

	</table>

	<table name="objectives_strategicLog" phpName='StrategicObjectiveLog' description="Strategic Objective Log">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Objective Id" autoIncrement="true"/>
		<column name="strategicId" type="INTEGER" description="Strategic Objective Id"/>
		<column name="policyGuidelineId" type="INTEGER" description="Policy Guideline Id"/>
		<column name="name" required="true"  type="LONGVARCHAR" size="255" description="Objective Name"/>
		<column name="description" type="LONGVARCHAR" description="Objective Description"/>
		<column name="exchangeRate" type="FLOAT" description="Exchange Rate" />
		<column name="userId" type="INTEGER" description="User Id " />
		<column name="affiliateId" required="true" type="INTEGER" description="Affiliate Id"/>
		<column name="userByAffiliatesId" type="INTEGER" description="UserByAffiliates Id" />
		<column name="updated" type="TIMESTAMP"  description="Updated"/>
		<column name="oldId" type="INTEGER" description="Old Id"/>
		<column name="changes" type="INTEGER" description="Cantidad de modificaciones"/>

		<foreign-key foreignTable="objectives_strategic" >
			<reference local="strategicId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="objectives_policyGuideline" >
			<reference local="policyGuidelineId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="users_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

<!--		<foreign-key foreignTable="affiliates_affiliate" >
			<reference local="affiliateId" foreign="id" />
		</foreign-key> -->

<!--		<foreign-key foreignTable="affiliates_user" >
			<reference local="userByAffiliatesId" foreign="id" />
		</foreign-key> -->

	</table>

	<table name="objectives_objectiveLog" phpName='ObjectiveLog' description="Objective Log">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Objective Id" autoIncrement="true"/>
		<column name="objectiveId" required="true" type="INTEGER" description="Objective Id" />
		<column name="name" required="true"  type="VARCHAR" size="255" description="Objective Name"/>
		<column name="policyGuidelineId" type="INTEGER" description="Policy Guideline Id"/>
		<column name="strategicObjectiveId" required="true" type="INTEGER" description="Strategic Objective Id"/>
		<column name="affiliateId" required="true" type="INTEGER" description="Affiliate Id"/>
		<column name="description" type="LONGVARCHAR" description="Objective Description"/>
		<column name="date" type="DATE"  description="Objective Date"/>
		<column name="expirationDate" type="DATE"  description="Objective Expiration Date (Fecha Vencimiento)"/>
		<column name="achieved" type="BOOLEAN"  description="is Objective achieved?"/>
		<column name="notes" type="LONGVARCHAR"  description="Objective Notes"/>
		<column name="responsibleCode" type="INTEGER" description="Position Code"/>
		<column name="userId" type="INTEGER" description="User Id " />
		<column name="userByAffiliatesId" type="INTEGER" description="UserByAffiliates Id" />
		<column name="updated" type="TIMESTAMP"  description="Updated"/>
		<column name="changes" type="INTEGER" description="Cantidad de modificaciones"/>
		<column name="oldId" type="INTEGER" description="Old Id"/>
	
		<foreign-key foreignTable="objectives_strategic" >
			<reference local="strategicObjectiveId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="objectives_objective" >
			<reference local="objectiveId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="objectives_policyGuideline" >
			<reference local="policyGuidelineId" foreign="id" />
		</foreign-key>

<!--		<foreign-key foreignTable="affiliates_affiliate" >
			<reference local="affiliateId" foreign="id" />
		</foreign-key> -->

		<foreign-key foreignTable="users_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

<!--		<foreign-key foreignTable="affiliates_user" >
			<reference local="userByAffiliatesId" foreign="id" />
		</foreign-key> -->

		<foreign-key foreignTable="positions_position" >
			<reference local="responsibleCode" foreign="id" />
		</foreign-key>

	</table>

</database>