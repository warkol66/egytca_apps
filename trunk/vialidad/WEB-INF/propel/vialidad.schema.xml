<database defaultIdMethod="native" package="vialidad.classes" name="application" >

	<table phpName="Bulletin" name="vialidad_bulletin">

		<column name="id" type="INTEGER" primaryKey="true" required="true" autoIncrement="true" />
		<column name="number" type="VARCHAR" size="10" required="true" primaryString="true" />
		<column name="bulletinDate" type="DATE" description="Fecha del Boletin" />

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table phpName="Supply" name="vialidad_supply">

		<column name="id" type="INTEGER" primaryKey="true" required="true" autoIncrement="true" />
		<column name="name" type="VARCHAR" size="255" required="true" primaryString="true" />

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table phpName="PriceBulletin" name="vialidad_priceBulletin">

		<column name="id"         type="INTEGER" required="true" primaryKey="true" />
		<column name="bulletinId" type="INTEGER" required="true" />
		<column name="supplyId"   type="INTEGER" required="true" />
		<column name="averagePrice" type="DECIMAL" size="12" scale="2" description="Precio provisorio" />
		<column name="definitive" type="BOOLEAN" description="Indica si el precio es definitivo o no" />

		<column name="supplierId1" type="INTEGER" required="true" />
		<column name="price1"      type="DECIMAL" size="12" scale="2" description="Precio provisorio, proveedor 1" />
		<column name="definitive1" type="BOOLEAN" description="Indica si el precio es definitivo o no, proveedor 1" />
		<column name="supplierDocument1" type="INTEGER" description="Documento respaldatorio, proveedor 1" />

		<column name="supplierId2" type="INTEGER" required="true" />
		<column name="price2"      type="DECIMAL" size="12" scale="2" description="Precio provisorio, proveedor 2" />
		<column name="definitive2" type="BOOLEAN" description="Indica si el precio es definitivo o no, proveedor 2" />
		<column name="supplierDocument2" type="INTEGER" description="Documento respaldatorio, proveedor 2" />

		<column name="supplierId3" type="INTEGER" required="true" />
		<column name="price3"      type="DECIMAL" size="12" scale="2" description="Precio provisorio, proveedor 3" />
		<column name="definitive3" type="BOOLEAN" description="Indica si el precio es definitivo o no, proveedor 3" />
		<column name="supplierDocument3" type="INTEGER" description="Documento respaldatorio, proveedor 3" />

		<foreign-key foreignTable="vialidad_bulletin" >
			<reference local="bulletinId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="vialidad_supply" >
			<reference local="supplyId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="vialidad_supplier" >
			<reference local="supplierId1" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="vialidad_supplier" >
			<reference local="supplierId2" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="vialidad_supplier" >
			<reference local="supplierId3" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="documents_document" >
			<reference local="supplierDocument1" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="documents_document" >
			<reference local="supplierDocument2" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="documents_document" >
			<reference local="supplierDocument3" foreign="id" />
		</foreign-key>

	</table>

	<table phpName="Supplier" name="vialidad_supplier" description="Proveedores">
		<column name="id" required="true" primaryKey="true" type="INTEGER" description="Id proveedor" autoIncrement="true" />
		<column name="name" required="true" type="VARCHAR" size="255" description="nombre proveedor" primaryString="true" />
		<column name="address" type="VARCHAR" size="255" description="Direccion proveedor"/>
		<column name="phone" type="VARCHAR" size="50" description="Telefono proveedor"/>
		<column name="email" type="VARCHAR" size="50" description="Email proveedor"/>
		<column name="contact" type="VARCHAR" size="50" description="Nombre de persona de contacto"/>
		<column name="contactEmail" type="VARCHAR" size="100" description="Email de persona de contacto"/>
		<column name="web" type="VARCHAR" size="255" description="Direccion web del proveedor"/>
		<column name="memo" type="LONGVARCHAR" description="Informacion adicional del proveedor"/>

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table phpName="Contract" name="vialidad_contract">

		<column name="id" type="INTEGER" primaryKey="true" required="true" autoIncrement="true" />
		<column name="code" type="VARCHAR" size="50" required="true" description="Codigo del contrato" />
		<column name="name" type="VARCHAR" size="255" required="true" primaryString="true" description="Nombre del contrato" />
		<column name="contractorId" type="INTEGER"  description="Id del contratista" />
		<column name="verifierId" type="INTEGER"  description="Id del verificador" />

		<foreign-key foreignTable="affiliates_affiliate" >
			<reference local="contractorId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="affiliates_affiliate" >
			<reference local="verifierId" foreign="id" />
		</foreign-key>

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table phpName="Construction" name="vialidad_construction">

		<column name="id" type="INTEGER" primaryKey="true" required="true" autoIncrement="true" />
		<column name="name" type="VARCHAR" size="255" required="true" primaryString="true" />
		<column name="contractId" type="INTEGER" description="Id del contrato" />
		<column name="description" type="LONGVARCHAR" />

		<foreign-key foreignTable="vialidad_contract" >
			<reference local="contractId" foreign="id" />
		</foreign-key>

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table phpName="ConstructionItem" name="vialidad_constructionItem">

		<column name="id" type="INTEGER" primaryKey="true" required="true" autoIncrement="true" />
		<column name="name" type="VARCHAR" size="255" required="true" primaryString="true" />

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table phpName="ConstructionItemRelation" name="vialidad_constructionItemRelation" isCrossRef="true">

		<column name="itemId" type="INTEGER" required="true" primaryKey="true" />
		<column name="supplyId" type="INTEGER" required="true" primaryKey="true" />
		<column name="proportion" type="DECIMAL" size="12" scale="2" description="Precio definitivo" />

		<foreign-key foreignTable="vialidad_constructionItem" >
			<reference local="itemId" foreign="id" />
		</foreign-key>

		<foreign-key foreignTable="vialidad_supply" >
			<reference local="supplyId" foreign="id" />
		</foreign-key>

	</table>

</database>
