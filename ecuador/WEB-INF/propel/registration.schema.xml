<database defaultIdMethod="native" package="registration.classes" name="application" >

	<table name="registration_user" phpName='RegistrationUser' description="Users by registration">

		<column name="id" required="true" primaryKey="true" type="INTEGER" description="User Id" autoIncrement="true"/>
		<column name="username" required="true"  type="VARCHAR" size="255" description="username"/>
        <validator column="username">
            <rule name="required" message="El Usuario es obligatorio" />
            <rule name="unique" message="El Usuario ya existe"/>
        </validator>
		<column name="password" required="true"  type="VARCHAR" size="255" description="password"/>
		<column name="active" required="true"  type="BOOLEAN"  description="Is user active?"/>
		<column name="verified" required="true"  type="BOOLEAN"  default='0' description="Is user verified?"/>
		<column name="created" required="true"  type="TIMESTAMP"  description="Creation date for"/>
		<column name="updated" required="true"  type="TIMESTAMP"  description="Last update date"/>
		<column name="ip" required="true"  type="VARCHAR" size="255" description="Registration IP" />
		<column name="lastLogin" type="TIMESTAMP" description="Fecha del ultimo login del usuario" />
		<column name="imported" required="true"  type="BOOLEAN"  default='0' description="Is user imported to the system?"/>
		<column name="verificationHash" type="VARCHAR" size="255" description="Hash de Verificacion de Creacion" />

		<behavior name="soft_delete" />

		<unique>
			<unique-column name="username" />
		</unique>

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

	<table name="registration_userInfo" phpName='RegistrationUserInfo' description="Information about users by registration">

		<column name="userId" required="true" primaryKey="true" type="INTEGER" description="UserByRegistration Id" />
		<column name="name" type="VARCHAR" size="255" description="name" required="true"/>
        <validator column="name">
            <rule name="required" message="El Nombre es obligatorio" />
        </validator>
		<column name="surname" type="VARCHAR" size="255" description="surname" required="true"/>
        <validator column="surname">
            <rule name="required" message="El Apellido es obligatorio" />
        </validator>
		<column name="mailAddress" type="VARCHAR" size="255" description="Email" required="true"/>
        <validator column="mailAddress">
            <rule name="required" message="La Dirección de Email es obligatoria" />
            <rule name="match"
            value="/^([a-zA-Z0-9])+([\.a-zA-Z0-9_-])*@([a-zA-Z0-9])+(\.[a-zA-Z0-9_-]+)+$/"
            message="La Dirección de Email es inválida" />
        </validator>
		<column name="alternateMailAddress" type="VARCHAR" size="255" description="Email Alternativo" />
        <validator column="mailAddress">
            <rule name="match"
                  value="/^([a-zA-Z0-9])+([\.a-zA-Z0-9_-])*@([a-zA-Z0-9])+(\.[a-zA-Z0-9_-]+)+$/"
                  message="La Dirección Alternativa de Email es inválida" />
        </validator>
		<column name="newsletterSubscribe" type="BOOLEAN" default="0" description="Indicador de subscripcion al newsletter" />
		<column name="occupation" type="VARCHAR" size="255" description="Profesion" />
		<column name="organization" type="VARCHAR" size="255" description="Organizacion" />
		<column name="telephone" type="VARCHAR" size="255" description="Telefono" />
		<column name="alternateTelephone" type="VARCHAR" size="255" description="Telefono Alternativo" />
		<column name="group" required="true" type="INTEGER" description="group" />
        <validator column="group">
            <rule name="required" message="El Grupo es obligatorio" />
        </validator>
		<column name="country" required="true" type="VARCHAR" size="255" description="Pais" />
        <validator column="country">
            <rule name="required" message="El País es obligatorio" />
        </validator>
		<column name="state" type="VARCHAR" size="255" description="Provincia" />
        <validator column="state">
            <rule name="required" message="La Provincia es obligatoria" />
        </validator>

		<foreign-key foreignTable="registration_user" >
			<reference local="userId" foreign="id" />
		</foreign-key>

		<vendor type="mysql">
			<parameter name="Charset" value="utf8"/>
			<parameter name="Collate" value="utf8_general_ci"/>
		</vendor>

	</table>

</database>
